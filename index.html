<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Dofus Archimonstres Tracker</title>
<style>
  :root {
  --green:#7CFFB2;
  --dark:#0b0f0f;
  --card:rgba(20,25,25,.75);
  --grey:#555;
}
*{box-sizing:border-box;font-family:"Barlow",system-ui,sans-serif}
body{margin:0;color:#fff;background:var(--dark);overflow-x:hidden}

/* BACKGROUND */
.video-bg{position:fixed;inset:0;z-index:-3}
.video-bg video{width:100%;height:100%;object-fit:cover;filter:blur(3px) grayscale(80%)}
.video-overlay{position:fixed;inset:0;background:rgba(8,10,10,.78);z-index:-2}
  
body{margin:0;background:#0b0f0f;color:#fff;font-family:Arial}
.container{max-width:1200px;margin:40px auto;padding:20px}
.etape{background:#141919;border-radius:18px;padding:20px;margin-bottom:25px}
.etape h2{color:#7CFFB2;margin-top:0}
.list{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:8px}
.archi{display:flex;gap:10px;align-items:center;padding:8px 12px;border-radius:10px;background:#1a2020;cursor:pointer}
.archi.checked{background:#3b4444}
.archi input{cursor:pointer}
.archi span{flex:1}
</style>
</head>

<body>

  <div class="video-bg">
  <video autoplay muted loop playsinline>
    <source src="https://duffus.fr/videos/fond.mp4" type="video/mp4">
  </video>
</div>
<div class="video-overlay"></div>
  
<div class="container">
<h1>Dofus Archimonstres</h1>
<div class="subtitle">
    Cliquez pour copier — cochez pour suivre votre progression
  </div>
  <div id="content"></div>
</div>

<script>
function copyText(text){
  const ta=document.createElement("textarea");
  ta.value=text;
  document.body.appendChild(ta);
  ta.select();
  document.execCommand("copy");
  document.body.removeChild(ta);
}

function normalizeName(name){
  return name
    .replace(/['’]/g,"")
    .replace(/\s+/g,"_")
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g,"");
}

const content=document.getElementById("content");

Object.entries(data).forEach(([etape,list])=>{
  const sec=document.createElement("div");
  sec.className="etape";

  const title=document.createElement("h2");
  sec.appendChild(title);

  const grid=document.createElement("div");
  grid.className="list";

  list.forEach((name,i)=>{
    const key=`archi_${etape}_${i}`;
    const row=document.createElement("div");
    row.className="archi";

    const cb=document.createElement("input");
    cb.type="checkbox";
    cb.checked=localStorage.getItem(key)==="1";

    const img=document.createElement("img");
    img.src=`images/${etape}/${normalizeName(name)}.png`;
    img.alt=name;
    img.style.width="32px";
    img.style.height="32px";
    img.style.objectFit="contain";

    const label=document.createElement("span");
    label.textContent=name;

    function update(){
      localStorage.setItem(key,cb.checked?"1":"0");
      row.classList.toggle("checked",cb.checked);
      updateCounter();
    }

    row.onclick=()=>{
      copyText(name);
      cb.checked=true;
      update();
    };

    cb.onclick=(e)=>{
      e.stopPropagation();
      copyText(name);
      update();
    };

    if(cb.checked)row.classList.add("checked");

    row.append(cb,img,label);
    grid.appendChild(row);
  });

  sec.appendChild(grid);
  content.appendChild(sec);

  function updateCounter(){
    const checked=grid.querySelectorAll("input:checked").length;
    title.textContent=`ETAPE ${etape} — ${checked} / ${list.length}`;
  }
  updateCounter();
});
</script>

</body>
</html>
